{"version":3,"file":null,"sources":["../src/index.js"],"sourcesContent":["/*\r\n * @Author: baby\r\n * @Date:   2016-08-19 23:50:53\r\n * @Last Modified by: mikey.zhaopeng\r\n * @Last Modified time: 2016-09-08 15:58:16\r\n */\r\n\r\n// 'use strict'\r\n\r\n// // 通过 rollup.js 编译， maths.js 中未调用的方法 square() 并未打包到新的js中。\r\n// import { cube } from './math.js'\r\n// console.log(cube(5)) // 125\r\n\r\nconst _lazyFlag = 'lazy-img'; // The mark of lazy load\r\nconst _viewPortHeight = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\r\nconst _viewPortWidth = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);\r\n\r\nclass LazyLoadImg {\r\n    constructor(elementId = '' ) {\r\n        this.elementId = elementId;\r\n        if(this.elementId && this.elementId.indexOf('#') < 0) {\r\n            this.elementId += '#';\r\n        }\r\n\r\n        if(!this._images) {\r\n            console.log('this._images');\r\n            this._images = (this.elementId ? document.querySelector(elementId).querySelectorAll(`img[${_lazyFlag}]`) : document.querySelectorAll(`img[${_lazyFlag}]`)) || [];\r\n        }\r\n    }\r\n    /**\r\n     * 自动加载\r\n     */\r\n    load() {\r\n        const images = this._images;\r\n        console.log('images: ', images);\r\n        if(images.length > 0) {\r\n            for(let i = 0, len = images.length; i < len; i++) {\r\n                const img = images[i];\r\n                console.log('load-img: ', img);\r\n                if(this.isOnVerticalViewPort(img) && this.isOnHorizontalViewPort(img)) {\r\n                    console.log('load: ${i}');\r\n                    const url = img.getAttribute(_lazyFlag);\r\n                    img.setAttribute('src', url);\r\n                    img.isload = true;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    init() {\r\n        const _self = this;\r\n        _self.load();\r\n        window.addEventListener('scroll', () => {\r\n            _self.load();\r\n        }, false);\r\n    }\r\n\r\n    isOnVerticalViewPort(ele) {\r\n        const rect = ele.getBoundingClientRect();\r\n        console.log('isOnVerticalViewPort: ', rect);\r\n        return rect.top > 0 && rect.top <= _viewPortHeight;\r\n    }\r\n\r\n    isOnHorizontalViewPort(ele) {\r\n        const rect = ele.getBoundingClientRect();\r\n        console.log('isOnHorizontalViewPort: ', rect);\r\n        return rect.left > 0 && rect.left <= _viewPortWidth;\r\n    }\r\n}\r\n\r\nexport default LazyLoadImg;\r\n"],"names":["_lazyFlag","_viewPortHeight","Math","max","document","documentElement","clientHeight","window","innerHeight","_viewPortWidth","clientWidth","innerWidth","LazyLoadImg","elementId","indexOf","_images","log","querySelector","querySelectorAll","images","length","i","len","img","isOnVerticalViewPort","isOnHorizontalViewPort","url","getAttribute","setAttribute","isload","_self","load","addEventListener","ele","rect","getBoundingClientRect","top","left"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;;;;;;;;;;AAaA,IAAMA,YAAY,UAAlB;AACA,IAAMC,kBAAkBC,KAAKC,GAAL,CAASC,SAASC,eAAT,CAAyBC,YAAlC,EAAgDC,OAAOC,WAAP,IAAsB,CAAtE,CAAxB;AACA,IAAMC,iBAAiBP,KAAKC,GAAL,CAASC,SAASC,eAAT,CAAyBK,WAAlC,EAA+CH,OAAOI,UAAP,IAAqB,CAApE,CAAvB;;IAEMC;2BAC2B;YAAjBC,SAAiB,yDAAL,EAAK;;;aACpBA,SAAL,GAAiBA,SAAjB;YACG,KAAKA,SAAL,IAAkB,KAAKA,SAAL,CAAeC,OAAf,CAAuB,GAAvB,IAA8B,CAAnD,EAAsD;iBAC7CD,SAAL,IAAkB,GAAlB;;;YAGD,CAAC,KAAKE,OAAT,EAAkB;oBACNC,GAAR,CAAY,cAAZ;iBACKD,OAAL,GAAe,CAAC,KAAKF,SAAL,GAAiBT,SAASa,aAAT,CAAuBJ,SAAvB,EAAkCK,gBAAlC,UAA0DlB,SAA1D,OAAjB,GAA2FI,SAASc,gBAAT,UAAiClB,SAAjC,OAA5F,KAA+I,EAA9J;;;;;;;;;;+BAMD;gBACGmB,SAAS,KAAKJ,OAApB;oBACQC,GAAR,CAAY,UAAZ,EAAwBG,MAAxB;gBACGA,OAAOC,MAAP,GAAgB,CAAnB,EAAsB;qBACd,IAAIC,IAAI,CAAR,EAAWC,MAAMH,OAAOC,MAA5B,EAAoCC,IAAIC,GAAxC,EAA6CD,GAA7C,EAAkD;wBACxCE,MAAMJ,OAAOE,CAAP,CAAZ;4BACQL,GAAR,CAAY,YAAZ,EAA0BO,GAA1B;wBACG,KAAKC,oBAAL,CAA0BD,GAA1B,KAAkC,KAAKE,sBAAL,CAA4BF,GAA5B,CAArC,EAAuE;gCAC3DP,GAAR,CAAY,YAAZ;4BACMU,MAAMH,IAAII,YAAJ,CAAiB3B,SAAjB,CAAZ;4BACI4B,YAAJ,CAAiB,KAAjB,EAAwBF,GAAxB;4BACIG,MAAJ,GAAa,IAAb;;;;;;;+BAMT;gBACGC,QAAQ,IAAd;kBACMC,IAAN;mBACOC,gBAAP,CAAwB,QAAxB,EAAkC,YAAM;sBAC9BD,IAAN;aADJ,EAEG,KAFH;;;;6CAKiBE,KAAK;gBAChBC,OAAOD,IAAIE,qBAAJ,EAAb;oBACQnB,GAAR,CAAY,wBAAZ,EAAsCkB,IAAtC;mBACOA,KAAKE,GAAL,GAAW,CAAX,IAAgBF,KAAKE,GAAL,IAAYnC,eAAnC;;;;+CAGmBgC,KAAK;gBAClBC,OAAOD,IAAIE,qBAAJ,EAAb;oBACQnB,GAAR,CAAY,0BAAZ,EAAwCkB,IAAxC;mBACOA,KAAKG,IAAL,GAAY,CAAZ,IAAiBH,KAAKG,IAAL,IAAa5B,cAArC;;;;IAIR;;;;"}